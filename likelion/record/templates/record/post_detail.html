{% extends 'record/base.html' %}
{% load static %}
{% load staticfiles %}
{% block content %}
<br><br><br>

<div class = "post" style="color:white">
    <h3 style="font-size : 40px;">{{ post.title }}</h3>
    <p>{{ post.text }}</p>
    <p> 작성자 : {{post.name_id}}</p>
    <p> 작성일 : {{ post.created_at }}</p>
    <p> 수정일 : {{ post.updated_at }}</p>
    <p>Category : {{ post.category }}</p>
    {% if post.file%}
    <P><img src = "{{post.file.url}}" alt=""></P>
    <p>File : <a id="id_uploaded_file" href="{{ post.file.url }}" download>{{ post.file }}</a></p>
    {% endif %}


<a href="{% url 'main' %}">Back</a>
<a href="{% url 'post_edit' post.id %}">Edit</a>
<a href="{% url 'post_delete' post.id %}" onclick="return confirm('정말로 삭제하시겠습니까?');">Delete</a>

<hr>

<form action='{% url 'comment_new' post.id %}' method = 'post'>
    {% csrf_token %}
    <table margin = >
        {{ form.as_table }}
    </table>
    <input type='submit' value='Save' class = "btn btn-info">
</form>


{% for comment in post.comment_set.all%}
    <div class="container" style="color:white">
        <p>
           {{comment.name_id}} : {{comment.text}}
        </p>
         <a href="{% url 'comment_delete' post.id comment.id  %}" class = "btn btn-warning float-right" role="button">Delete</a>
    </div>
    {% for recomment in comment.recomment_set.all%}
        <div class="container" style="color:white">
            <p>
                ㄴ{{recomment.text}}
            </p>
            <a href="{% url 'recomment_delete' post.id comment.id recomment.id %}" class = "btn btn-warning float-right" role="button">Delete</a>
        </div>
    {% endfor %}
    


<button data-toggle="collapse" data-target="#demo" class = "btn btn-info">대댓글 작성하기</button>

<div id="demo" class="collapse">
    <div class="card card-body">
                    {% comment %} <p>
                        대댓글작성
                    </p> {% endcomment %}
        <form action='{% url 'recomment_new' post.id comment.id %}' method = 'post'>
            {% csrf_token %}
                <table margin = >
                    {{ form.as_table }}
                </table>
                <input type='submit' value='Save' class = "btn btn-info">
        </form>

    </div>
</div>
</div>

{% empty %}
    <p>Comment here</p>
{% endfor %}

{% endblock %}